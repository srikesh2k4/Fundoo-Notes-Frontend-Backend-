<div class="note-input-container" 
     [style.background-color]="selectedColor() === '#ffffff' || selectedColor() === '#FFFFFF' ? null : selectedColor()"
     (click)="closeMenus()">
  
  <!-- Collapsed State -->
  <div class="note-input-collapsed" 
       *ngIf="!isExpanded()"
       (click)="expand()">
    <input 
      type="text" 
      placeholder="Take a note..." 
      class="collapsed-input"
      readonly>
    
    <div class="icon-group">
      <button class="icon-btn" aria-label="New list" title="New list">
        <svg viewBox="0 0 24 24">
          <path d="M9 5H21V7H9V5ZM9 11H21V13H9V11ZM9 17H21V19H9V17ZM3 5H7V7H3V5ZM3 11H7V13H3V11ZM3 17H7V19H3V17Z"></path>
        </svg>
      </button>

      <button class="icon-btn" aria-label="New note with drawing" title="New note with drawing">
        <svg viewBox="0 0 24 24">
          <path d="M3 17.25V21H6.75L17.81 9.94L14.06 6.19L3 17.25ZM20.71 7.04C21.1 6.65 21.1 6.02 20.71 5.63L18.37 3.29C17.98 2.9 17.35 2.9 16.96 3.29L15.13 5.12L18.88 8.87L20.71 7.04Z"></path>
        </svg>
      </button>

      <button class="icon-btn" aria-label="New note with image" title="New note with image">
        <svg viewBox="0 0 24 24">
          <path d="M21 19V5C21 3.9 20.1 3 19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19ZM8.5 13.5L11 16.5L14.5 12L19 18H5L8.5 13.5Z"></path>
        </svg>
      </button>
    </div>
  </div>


  <!-- Expanded State -->
  <div class="note-input-expanded" *ngIf="isExpanded()">
    
    <!-- Title Input -->
    <input 
      type="text" 
      [(ngModel)]="title"
      placeholder="Title" 
      class="title-input"
      (click)="$event.stopPropagation()">


    <!-- Content Input -->
    <textarea 
      [(ngModel)]="content"
      placeholder="Take a note..." 
      class="content-input"
      rows="3"
      (click)="$event.stopPropagation()"></textarea>


    <!-- Action Bar -->
    <div class="action-bar">
      <div class="action-icons">
        
        <!-- Reminder Button -->
        <button class="action-btn" aria-label="Remind me" title="Remind me">
          <svg viewBox="0 0 24 24">
            <path d="M12 22C13.1 22 14 21.1 14 20H10C10 21.1 10.9 22 12 22ZM18 16V11C18 7.93 16.36 5.36 13.5 4.68V4C13.5 3.17 12.83 2.5 12 2.5S10.5 3.17 10.5 4V4.68C7.64 5.36 6 7.92 6 11V16L4 18V19H20V18L18 16Z"></path>
          </svg>
        </button>


        <!-- Collaborator Button -->
        <button class="action-btn" aria-label="Collaborator" title="Collaborator">
          <svg viewBox="0 0 24 24">
            <path d="M16 11C17.66 11 18.99 9.66 18.99 8C18.99 6.34 17.66 5 16 5C14.34 5 13 6.34 13 8C13 9.66 14.34 11 16 11ZM8 11C9.66 11 10.99 9.66 10.99 8C10.99 6.34 9.66 5 8 5C6.34 5 5 6.34 5 8C5 9.66 6.34 11 8 11ZM8 13C5.67 13 1 14.17 1 16.5V18H15V16.5C15 14.17 10.33 13 8 13ZM16 13C15.71 13 15.38 13.02 15.03 13.05C16.19 13.89 17 15.02 17 16.5V18H23V16.5C23 14.17 18.33 13 16 13Z"></path>
          </svg>
        </button>


        <!-- Color Picker -->
        <div class="color-picker-container">
          <button class="action-btn" 
                  aria-label="Background options" 
                  title="Background options"
                  (click)="toggleColorPicker($event)">
            <svg viewBox="0 0 24 24">
              <path d="M12 22C6.48 22 2 17.52 2 12C2 6.48 6.48 2 12 2C17.52 2 22 6.04 22 11C22 14.31 19.31 17 16 17H14.5C14.22 17 14 17.22 14 17.5C14 17.61 14.04 17.71 14.11 17.79C14.43 18.17 14.63 18.65 14.63 19.17C14.63 20.31 13.69 21.25 12.55 21.25H12V22Z"></path>
            </svg>
          </button>


          <!-- Color Picker Palette -->
          <div class="color-picker" *ngIf="showColorPicker()">
            <button *ngFor="let color of colors"
                    class="color-btn"
                    [style.background-color]="color.value"
                    [class.selected]="selectedColor() === color.value"
                    [attr.title]="color.name"
                    (click)="selectColor(color.value, $event)">
              <svg viewBox="0 0 24 24" *ngIf="selectedColor() === color.value">
                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"></path>
              </svg>
            </button>
          </div>
        </div>


        <!-- Image Button -->
        <button class="action-btn" aria-label="Add image" title="Add image">
          <svg viewBox="0 0 24 24">
            <path d="M21 19V5C21 3.9 20.1 3 19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19ZM8.5 13.5L11 16.5L14.5 12L19 18H5L8.5 13.5Z"></path>
          </svg>
        </button>


        <!-- Archive Button -->
        <button class="action-btn" aria-label="Archive" title="Archive">
          <svg viewBox="0 0 24 24">
            <path d="M20.54 5.23L19.15 3.55C18.88 3.21 18.47 3 18 3H6C5.53 3 5.12 3.21 4.85 3.55L3.46 5.23C3.17 5.57 3 6.02 3 6.5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V6.5C21 6.02 20.83 5.57 20.54 5.23ZM6.12 5H17.88L18.7 6H5.3L6.12 5ZM5 19V8H19V19H5Z"></path>
          </svg>
        </button>


        <!-- More Options Button -->
        <button class="action-btn" aria-label="More" title="More">
          <svg viewBox="0 0 24 24">
            <path d="M12 8C13.1 8 14 7.1 14 6C14 4.9 13.1 4 12 4C10.9 4 10 4.9 10 6C10 7.1 10.9 8 12 8ZM12 14C13.1 14 14 13.1 14 12C14 10.9 13.1 10 12 10C10.9 10 10 10.9 10 12C10 13.1 10.9 14 12 14ZM12 20C13.1 20 14 19.1 14 18C14 16.9 13.1 16 12 16C10.9 16 10 16.9 10 18C10 19.1 10.9 20 12 20Z"></path>
          </svg>
        </button>
      </div>

x
      <!-- Close Button -->
      <button class="close-btn" (click)="close()">Close</button>
    </div>
  </div>
</div>
